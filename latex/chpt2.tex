\chapter{Θεωρητικό Υπόβαθρο}

\section{Βάσεις δεδομένων}

Με τον όρο βάση δεδομένων εννοούμε μία συλλογή από οργανωμένα δεδομένα, τα οποία μπορούν διαχειριστούν με εύκολο τρόπο. Ένα σύστημα διαχείρισης βάσεων δεδομένων 
είναι ένα λογισμικό που αλληλεπιδρά με τον χρήστη και άλλες εφαρμογές, με σκοπό τον ορισμό, την πρόσβαση, τη διαχείριση και τις επερωτήσεις στα δεδομένα που είναι 
αποθηκευμένα στη βάση δεδομένων. Οι βάσεις δεδομένων χρησιμοποιούνται ευρέως σε πολλές υπηρεσίες που αφορούν διάφορους τομείς της ανθρώπινης δραστηριότητας, όπως 
υπηρεσίες που προσφέρονται από τράπεζες, πανεπιστήμια και τηλεπικοινωνιακούς φορείς.

\subsection{Σχεσιακή βάση δεδομένων}

Ο όρος σχεσιακή βάση δεδομένων χρησιμοποιείται για να περιγράψει μία βάση δεδομένων που οργανώνει τα δεδομένα της με γνώμονα το σχεσιακό μοντέλο δεδομένων. Σύμφωνα 
με το μοντέλο αυτό, τα δεδομένα οργανώνονται σε πίνακες από γραμμές και στήλες, με κάθε γραμμή να περιέχει ένα μοναδικό κλειδί. Ο πίνακας αντιπροσωπεύει μία οντότητα, 
κάθε γραμμή αντιστοιχεί σε μία εφαρμογή της οντότητας και οι στήλες αποτελούν χαρακτηριστικά της οντότητας. Ανάμεσα στους διάφορους πίνακες της βάσης μπορεί να υπάρχουν 
σχέσεις από 'έναν σε έναν', από 'έναν σε πολλούς' ή και από 'πολλούς σε πολλούς', όπως χαρακτηριστικά ονομάζονται. Πιο συγκεκριμένα, η σχέση είναι ένα σύνολο από 
εγγραφές-γραμμές πινάκων που έχουν κοινά γνωρίσματα-στήλες. Άλλοι όροι που συναντά κανείς σε μία σχεσιακή βάση δεδομένων είναι το πρωτεύον κλειδί, το οποίο είναι ένα 
μοναδικό αναγνωριστικό μίας εγγραφής σε έναν πίνακα. Όταν ένα πρωτεύον κλειδί, είναι κοινό και για έναν άλλον πίνακα, τότε γίνεται εξωτερικό κλειδί στον πίνακα αυτό. Τέλος, 
το ευρετήριο σε ένα γνώρισμα μίας σχέσης είναι μία δομή αναζήτησης η οποία παρέχει γρηγορότερη πρόσβαση στα δεδομένα.

\subsection{Σύνολο ιδιοτήτων ACID}

Ένα σύστημα διαχείρισης βάσεων δεδομένων πρέπει να είναι συμβατό με το σύνολο ιδιοτήτων ACID, έτσι ώστε η λειτουργία της βάσης να θεωρείται έγκυρη και αποτελεσματική. 
Πρόκειται για τέσσερις βασικές αρχές που εξασφαλίζουν την αξιόπιστη ολοκλήρωση των δοσοληψιών σε μία βάση δεδομένων. Οι αρχές αυτές είναι η ατομικότητα, η συνέπεια, 
η απομόνωση και η μονιμότητα. Πιο αναλυτικά, η ατομικότητα απαιτεί η τροποποίηση, που θα γίνει στη βάση δεδομένων, να πραγματοποιηθεί είτε ολόκληρη είτε καθόλου. 
Έτσι, αν ένα μέρος της δοσοληψίας αποτύχει, θα πρέπει να αποτύχει και ολόκληρη η δοσοληψία. Η συνέπεια διασφαλίζει ότι η βάση δεδομένων θα βρίσκεται πάντα σε συνεπή 
κατάσταση. Η απομόνωση προϋποθέτει ότι οι δοσοληψίες δε μπορούν να έχουν πρόσβαση σε δεδομένα της βάσης τα οποία τροποποιούνται εκείνη τη στιγμή από κάποια άλλη δοσολοψία. 
Τέλος, η μονιμότητα εγγυάται στον χρήστη ότι τα αποτελέσματα μίας ολοκληρωμένης δοσοληψίας θα παραμείνουν στη βάση δεδομένων ακόμη και σε περίπτωση σφάλματος ή 
διακοπής λειτουργίας του συστήματος διαχείρισης της βάσης δεδομένων. 


\section{PostgreSQL}

Η PostgreSQL είναι μία αντικειμενοστρεφής-σχεσιακή βάση δεδομένων ανοιχτού κώδικα. Παρέχει πλήρη υποστήριξη για εξωτερικά κλειδιά, συνενώσεις, όψεις και πληθώρα 
τύπων δεδομένων. Μπορεί να εγκατασταθεί στα περισσότερα δημοφιλή λειτουργικά συστήματα, όπως Unix και Windows. Επίσης, διαθέτει περιβάλλον ανάπτυξης κώδικα σε γλώσσες 
προγραμματισμού, όπως C/C++, Java, Perl, Python, Ruby. Μπορεί να διαχειριστεί εύκολα μεγάλους αριθμούς ταυτόχρονων χρηστών καθώς και μεγάλο όγκο δεδομένων. Ενδεικτικά, 
το μέγιστο μέγεθος πίνακα είναι 32ΤΒ, εγγραφής είναι 1.6ΤΒ, πεδίου 1GB, ενώ τα μέγιστα μεγέθη βάσης, πλήθους εγγραφών και ευρετηρίων σε κάθε πίνακα είναι απεριόριστα. 
Επιπλέον, δίνει τη δυνατότητα στον χρήστη να δημιουργήσει νέους τύπους δεδομένων αλλά και να ορίσει νέες συναρτήσεις. Επιπρόσθετα, διαχωρίζει τα δικαιώματα πρόσβασης στα 
σχήματα της βάσης με τη λογική των ρόλων. Κάθε ρόλος αντιπροσωπεύει έναν μεμονωμένο ή μία ομάδα χρηστών που έχουν με συγκεκριμένα δικαιώματα πρόσβασης στο κάθε σχήμα 
της βάσης. Τέλος, η PostgreSQL υποστηρίζει διάφορες επεκτάσεις που προσδίδουν επιπλέον δυνατότητες στη λειτουργία και χρήση της.

\subsection{PostGIS}

Το PostGIS είναι μία επέκταση της PostgreSQL, η οποία παρέχει υποστήριξη για γεωγραφικά αντικείμενα στη βάση. Στην ουσία δίνει τη δυνατότητα στη βάση να αποθηκεύει 
και να διαχειρίζεται χωρικά δεδομένα για Γεωγραφικά Συστήματα Πληροφοριών (GIS), ορίζοντας νέους τύπους δεδομένων όπως ο γεωμετρικός και ο γεωγραφικός τύπος. 
Επίσης, ορίζει νέες συναρτήσεις, τελεστές και ευρετήρια ειδικά για τους νέους τύπους χωρικών δεδομένων. Με τον τρόπο αυτό, μπορούν να πραγματοποιηθούν 
με αποδοτικό τρόπο επερωτήσεις (queries) για χωρικά δεδομένα. 

Ενδεικτικά, το PostGIS επιτρέπει την αποθήκευση στην PostgreSQL των γεωγραφικών συντεταγμένων ενός σημείου στο χάρτη. Οι συντεταγμένες αυτές αποτελούνται από ένα 
ζεύγος αριθμών, το γεωγραφικό πλάτος (latitude) και το γεωγραφικό μήκος (longitude). Το PostGIS δίνει την επιλογή αποθήκευσης των συντεταγμένων ως ένα γεωγραφικό 
τύπο δεδομένων (geography type). Επιπλέον, παρέχει μία πληθώρα συναρτήσεων για αυτό το γεωγραφικό τύπο δεδομένων, που καθιστούν δυνατό τον υπολογισμό των πραγματικών 
αποστάσεων μεταξύ γεωγραφικών σημείων. Με τον τρόπο αυτόν, μπορούν για παράδειγμα να γίνουν επερωτήσεις σχετικά με το πλήθος σημείων που βρίσκονται σε συγκεκριμένη 
απόσταση από ένα κεντρικό σημείο.

\subsection{Ευρετήρια}

Ένα ευρετήριο επιτρέπει στο σύστημα της βάσης δεδομένων να βρίσκει και να ανακτά μία εγγραφή πολύ ταχύτερα από ότι με μία σειριακή αναζήτηση της εγγραφής στον πίνακα 
της βάσης. Η χρήση ενός ευρετηρίου δημιουργεί μία πιο σύνθετη αναζήτηση για το σύστημα της βάσης, αλλά αν χρησιμοποιηθεί σωστά μπορεί να βελτιώσει σημαντικά την επίδοση του 
συστήματος. 

\subsubsection{Β-δέντρο}

Αν δεν καθοριστεί ρητά, η PostgreSQL χρησιμοποιεί B-δέντρο (B-tree) ευρετήριο στο πεδίο του πίνακα στο οποίο αυτό ανατίθεται. Το Β-δέντρο είναι μία δενδρική δομή δεδομένων η οποία 
κρατά τα δεδομένα ταξινομημένα και επιτρέπει αναζητήσεις, εισαγωγές και διαγραφές εγγραφών σε λογαριθμικό χρόνο. Είναι στην ουσία είναι ένα ισοσκελισμένο δέντρο με τους 
κόμβους του να περιέχουν δείκτες προς τις εγγραφές της βάσης και ένα πλήθος από κλειδιά που δρουν ως διαχωριστικές τιμές για υποδέντρα. Για παράδειγμα, αν ένας 
εσωτερικός κόμβος έχει 3 κόμβους-παιδιά τότε θα πρέπει να περιέχει δύο κλειδιά. Όλες οι τιμές στο αριστερό υποδέντρο πρέπει να είναι μικρότερες από το πρώτο κλειδί, 
οι τιμές του μεσαίου υποδέντρου θα έχουν αξία ανάμεσα στο πρώτο και δεύτερο κλειδί και το δεξί υποδέντρο θα πρέπει να έχει τιμές μεγαλύτερες από το δεύτερο κλειδί. 
Το Β-δέντρο είναι ειδικά βελτιστοποιημένο για συστήματα που διαβάζουν και γράφουν μεγάλα μπλοκ δεδομένων.

\subsubsection{R-δέντρο}

To ευρετήριο R-δέντρο (R-tree) είναι μία δενδρική δομή δεδομένων για πολυδιάστατη πληροφορία όπως γεωγραφικές συντεταγμένες. Η βασική ιδέα αυτής της δομής δεδομένων είναι η 
ομαδοποίηση κοντινών αντικειμένων και η αναπαράστασή τους με ένα ελάχιστο ορθογώνιο οριοθέτησης (minimum bounding rectangle) στο επόμενο υψηλότερο επίπεδο του δέντρου. 
Στο επίπεδο των φύλλων κάθε τέτοιο ορθογώνιο περιγράφει ένα μεμονωμένο αντικείμενο, ενώ σε υψηλότερο επίπεδο αποτελεί μία ένωση αντικειμένων. Το R-δέντρο είναι 
ισοσκελισμένη δενδρική δομή αναζήτησης, οπότε όλα τα φύλλα βρίσκονται στο ίδιο επίπεδο. Η κεντρική ιδέα στην υλοποίηση των αλγόριθμων αναζήτησης είναι η χρήση των 
ορθογωνίων οριοθέτησης για να αποφασιστεί αν πρέπει να συνεχιστεί η αναζήτηση στο αντίστοιχο υποδέντρο. Για το λόγο αυτό τα R-δέντρα είναι κατάλληλα για αναζήτηση σε μεγάλο όγκο 
δεδομένων. 

\subsubsection{GiST}

Το ευρετήριο GiST είναι ένα γενικευμένο δέντρο αναζήτησης που συναντά κανείς στην PostgreSQL. Χρησιμοποιείται για να βελτιστοποιήσει την αναζήτηση σε τύπους δεδομένων 
για τους οποίους δε μπορεί να 
εφαρμοστεί το Β-δέντρο. Ενοποιεί ένα πλήθος από δημοφιλή δέντρα αναζήτησης (όπως B+-δέντρο, R-δέντρο) σε μία δομή δεδομένων. Το ευρετήριο GiST 
είναι μία δενδρική δομή με κόμβους που περιλαμβάνουν ένα ζεύγος τιμών (p, ptr). Η τιμή p του ζεύγους χρησιμοποιείται ως κλειδί αναζήτησης και η τιμή ptr ως δείκτης σε 
δεδομένα για κόμβο-φύλλο του δέντρου ή δείκτης σε άλλο κόμβο αν ο κόμβος είναι ενδιάμεσος. Το κλειδί p αντιπροσωπεύει μία ιδιότητα που γίνεται αληθής για όλα τα 
δεδομένα που μπορούμε να φτάσουμε με τον δείκτη ptr. Επιπλέον, το ευρετήριο GiST μπορεί να υποστηρίξει οποιοδήποτε 
τελεστή επερώτησης (query predicate), αρκεί να υλοποιηθούν ορισμένες μέθοδοι που θα καθορίσουν τη συμπεριφορά των κλειδιών του δέντρου.

Στην επέκταση PostGIS της PostgreSQL μπορεί να γίνει χρήση ευρετηρίου GiST σε κάποιο γνώρισμα-στήλη ενός πίνακα. Όταν η στήλη αυτή είναι γεωγραφικός τύπος δεδομένων τότε 
το ευρετήριο GiST θα εφαρμόσει μία βελτιστοποιημένη εκδοχή ευρετηρίου τύπου R-tree (R-tree-over-GiST scheme). H PostgreSQL δεν επιτρέπει, στις πρόσφατες εκδόσεις της, 
τη χρήση μεμονωμένου R-tree γιατί δε μπορούν να διαχειριστούν γνωρίσματα με μέγεθος πάνω από 8Κ και αποτυγχάνουν όταν μία στήλη γεωγραφικού τύπου έχει κενή τιμή (null).

\section{Google Maps Directions API}

Το Google Maps Directions API είναι μία υπηρεσία που υπολογίζει οδηγίες (directions) μεταξύ σημείων του χάρτη χρησιμοποιώντας μία HTTP αίτηση (request). 
Μία HTTP αίτηση στο Directions API έχει την ακόλουθη μορφή:
\begin{center}
  http://maps.googleapis.com/maps/api/directions/output?parameters
\end{center}
Το πεδίο output καθορίζει τον τύπο αρχείου που θα περιέχει την απάντηση στην HTTP αίτηση και μπορεί να είναι json ή xml. Το πεδίο parameters καθορίζει τις 
παραμέτρους που θα συνοδεύουν την αίτηση. Υποχρεωτικές παράμετροι είναι η αφετηρία (origin) και ο προορισμός (destination) της διαδρομής για την οποία γίνεται αίτηση 
οδηγιών στο Directions API. Οι παράμετροι αυτές μπορεί να είναι είτε οι γεωγραφικές συντεταγμένες των αντίστοιχων σημείων εφ'όσον είναι γνωστές, είτε η διεύθυνση τους 
ως κείμενο. Στη δεύτερη περίπτωση, η υπηρεσία θα μετατρέψει τη διεύθυνση στις αντίστοιχες γεωγραφικές συντεταγμένες. Επιπλέον παράμετροι που μπορούν να καθοριστούν 
είναι το μέσο μετακίνησης (mode) που μπορεί να είναι αυτοκίνητο (driving), περπάτημα (walking), ποδήλατο (bicycling), ή μέσα μαζικής μεταφοράς (transit). Για παράδειγμα, 
μία ολοκληρωμένη HTTP αίτηση στο Directions API μπορεί να είναι η εξής:
\begin{center}
 http://maps.googleapis.com/maps/api/directions/json?origin=37.976159, 23.776274\&destination=37.978180, 23.768957\&mode=walking
\end{center}

\subsection{Αρχείο απάντησης JSON}

Ένα αρχείο τύπου JSON (Javascript Object Notation) χρησιμοποιεί κείμενο για να μεταφέρει αντικείμενα δεδομένων αποτελούμενα από ζεύγη πεδίων και τιμών. 

\subsubsection{Πεδίο status}

Το πεδίο status στην απάντηση της HTTP αίτησης περιλαμβάνει την κατάσταση της αίτησης. Η τιμή του πεδίου status μπορεί να πάρει μία από τις ακόλουθες τιμές:
\begin{itemize}
 \item OK, η οποία υποδηλώνει ότι η απάντηση περιλαμβάνει ένα έγκυρο αποτέλεσμα 
 \item NOT\_FOUND, η οποία δείχνει ότι η αφετηρία ή ο προορισμός δεν είναι έγκυροι
 \item ZERO\_RESULTS, σύμφωνα με την οποία δε βρέθηκε κάποια διαδρομή με βάση τις παραμέτρους που αρχικοποιήθηκαν
 \item INVALID\_REQUEST όταν κάποια παράμετρος ή τιμή της είναι δεν είναι αποδεκτή
 \item REQUEST\_DENIED όταν η υπηρεσία αρνήθηκε την αίτηση 
 \item UNKNOWN\_ERROR όταν υπήρξε σφάλμα από την πλευράς της υπηρεσίας
 \item OVER\_QUERY\_LIMIT όταν το πλήθος των αιτήσεων από τη συγκεκριμένη εφαρμογή υπερέβη το όριο που έχει τεθεί από την υπηρεσία. Πιο 
συγκεκριμένα, οι χρήστες του ελέθευρου Directions API μπορούν να κάνουν το πολύ δύο αιτήσεις ανά δευτερόλεπτο και 2500 αιτήσεις ανά ημέρα.
\end{itemize}

\subsubsection{Πεδίο routes}

Το πεδίο routes είναι ένας JSON πίνακας, κάθε στοιχείο του οποίου είναι μία διαφορετική διαδρομή (route) ανάμεσα στην καθορισμένη αφετηρία και προορισμό. 
Κάθε διαδρομή μπορεί να περιέχει τα ακόλουθα πεδία:

\begin{itemize}
 \item summary: μία σύντομη περιγραφή για τη διαδρομή, ώστε να διαχωρίζεται από τις εναλλακτικές διαδρομές, αν αυτές υπάρχουν.
 \item legs[]: πίνακας με πληροφορία για ένα κομμάτι της διαδρομής, αν έχουν καθοριστεί ενδιάμεσα σημεία (waypoints). Αν δεν υπάρχουν ενδιάμεσα σημεία ο πίνακας 
 θα περιέχει ένα στοιχείο, το οποίο θα είναι η συνολική διαδρομή.
 \item waypoint\_order: η σειρά των ενδιάμεσων σημείων, αν αυτά έχουν αρχικοποιηθεί.
 \item overview\_polyline: μία κωδικοποιημένη αναπαράσταση (encoded polyline) της διαδρομής.
 \item bounds: τα γεωγραφικά όρια για το πεδίο overview\_polyline.
 \item copyrights: τα πνευματικά δικαιώματα της υπηρεσίας σε μορφή κειμένου.
 \item warnings[]: ένας πίνακας με προειδοποιήσεις που πρέπει να γίνουν γνωστές όταν παρουσιάζεται η διαδρομή.
\end{itemize}

\subsubsection{Πεδίο legs[]}

Κάθε κομμάτι της διαδρομής (leg) μπορεί να περιέχει τα παρακάτω πεδία:

\begin{itemize}
 \item steps[]: πίνακας με τα βήματα σε κάθε κομμάτι διαδρομής.
 \item distance: η συνολική απόσταση που αντιστοιχεί στο κομμάτι της διαδρομής, το πεδίο value περιέχει την τιμή της απόστασης σε μέτρα και το πεδίο text μία λεκτική περιγραφή της 
 απόστασης.
 \item duration: η συνολική διάρκεια για το κομμάτι της διαδρομής, το πεδίο value περιέχει την τιμή της διάρκειας σε δευτερόλεπτα και το πεδίο text μία 
 λεκτική περιγραφή της διάρκειας. 
 \item start\_location: οι γεωγραφικές συντεταγμένες της αφετηρίας του συγκεκριμένου κομματιού της διαδρομής. Αυτές μπορεί να διαφέρουν από τις συνταταγμένες που 
 καθορίστηκαν στην παράμετρο origin της HTTP αίτησης, γιατί η υπηρεσία του Directions API υπολογίζει τις οδηγίες χρησιμοποιώντας ως αρχή και τέλος το κοντινότερο σημείο 
 μεταφοράς, όπως έναν δρόμο.
 \item start\_address: λεκτική περιγραφή του πεδίου start\_location, όπως η διεύθυνση της αφετηρίας.
 \item end\_location: αντίστοιχα με το πεδίο start\_location, για τον προορισμό του συγκεκριμένου κομματιού διαδρομής.
 \item end\_address: αντίστοιχα με το πεδίο start\_address, για το τελικό σημείο του κομματιού της διαδρομής.
\end{itemize}


\subsection{Encoded polyline}













